# NumberRecognizer
Нейросеть для распознавания одной цифры
## Структура проекта
- В папке **templates** находятся шаблоны цифр (в формате **.txt** и **.png**), которые нейросеть будет распознавать. Их размер 5 x 7 пикселей.
- Файл **init.py** нужен для инициализации нейрона. Он создает матрицу весов, заданных случайно и записывает в файл **weights.txt**.
Обратите внимание, что если файл существует, то он будет перезаписан, но будет выдано предупреждение.
- Скрипт **learning.py** производит обучение нейросети. При запуске необходимо указать целевое число, формат файла для распознавания и количество эпох.
В результате на каждой итерации веса будет перерасчитаны и записаны в файл.
- Программа **test.py** осуществляет проверку работы сети. Необходимо выбрать целевой образ (название файла, которое не обязательно должно быть числом) и его формат.
В результате в консоль будет выдана информация о том какие нейроны среагировали на поданный образ.
- Файл **utils.py** содержит вспомогательные функции, которые используются в других файлах. Среди них чтение/запись в нужных форматах, функция создания единичной матрицы,
функция перемножения матриц, функция преобразования размерности матрицы и функция для конвертирования изображения в формате png в текстовый файл, содержащий нули и единицы.
- Скрипт **visualization.py** отображает матрицы весов в виде heatmap.
## Алгоритм обучения
1) Считываем входные данные из файла в виде одномерной матрицы нулей(белый пиксель) и единиц(черный пиксель). Для изображения 5 x 7 она будет содержать 35 элементов.
2) Создаем единицную  матрицу target (потому что обучение с учителем).
3) Считываем веса из файла в массив размерности 10(по количеству цифр) x 35 (по количеству входов)
4) Сумматор: Перемножаем матрицы входных данных на матрицу весов. Получаем новую матрицу **z**.
5) Функция активации: Сравниваем каждый элемент выходной матрицы **z** с некоторым пороговым значением. Если он больше порога заменяем его на единицу, если меньше - на ноль.
6) Расчет ошибок сети: Вычисляем ошибку как разность между целевым и выходным значением. На выходе получаем массив из 10 элементов.
7) Перерасчет весов: Вычисляем новые веса по формуле `w[i][j] = w[i][j] + e[i] * n * x[j]`, где n - темп обучения.
8) Запись новых весов в файл
9) Повторяем шаги 3-8 на каждой эпохе.
